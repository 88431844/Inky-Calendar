echo -e "\e[1;36m"Running apt-get update and apt-get dist-upgrade for you..."\e[0m"
sudo apt-get update > /dev/null 2>&1 && sudo apt-get dist-upgrade -y > /dev/null 2>&1
echo -e "\e[1;36m"System successfully updated and upgraded!"\e[0m"

echo -e "\e[1;36m"Installing a few packages that are missing on Raspbian Stretch Lite..."\e[0m"
sudo apt-get install python3-pip -y > /dev/null 2>&1
sudo apt-get install RPi.GPIO -y > /dev/null 2>&1
sudo apt-get install python3-spidev -y > /dev/null 2>&1
sudo apt-get install git -y > /dev/null 2>&1
pip3 install Pillow > /dev/null 2>&1
sudo pip3 install Pillow > /dev/null 2>&1
sudo apt-get install libopenjp2-7-dev -y > /dev/null 2>&1
sudo apt install libtiff5 -y > /dev/null 2>&1

echo -e "\e[1;36m"Cleaning a bit of mess to free up some space..."\e[0m"

sudo apt-get clean > /dev/null 2>&1 && sudo apt-get autoremove -y > /dev/null 2>&1
echo -e "\e[1;36m"Installing the E-Paper-Calendar Software"\e[0m"

git clone https://github.com/aceisace/Raspberry-Pi-Google-Calendar-with-E-Paper-display
mv Raspberry-Pi-Google-Calendar-with-E-Paper-display E-Paper-Master
rm /home/pi/E-Paper-Master/Packages-installer

echo -e "\e[1;36m"Installing a few required packages for the E-Paper Software"\e[0m"
sudo pip3 install pyowm > /dev/null 2>&1
sudo pip3 install ics > /dev/null 2>&1
pip3 install pyowm > /dev/null 2>&1
pip3 install ics > /dev/null 2>&1

echo -e "\e[1;36m"Setting up the script  to start at boot..."\e[0m"
sudo apt-get install supervisor -y > /dev/null 2>&1

sudo bash -c 'cat > /etc/supervisor/conf.d/E-Paper.conf' << EOF
[program:E-Paper]
command = sudo /usr/bin/python3.5 /home/pi/E-Paper-Master/Calendar/stable.py
stdout_logfile = /home/pi/E-Paper-Master/E-Paper.log
stderr_logfile = /home/pi/E-Paper-Master/E-Paper-err.log
EOF

sudo service supervisor start E-Paper > /dev/null 2>&1
echo -e "\e[1;36m"The install was successful"\e[0m"
echo -e "\e[1;36m"The script will now start at every boot."\e[0m"
echo -e "\e[1;31m"Do not forget to add your iCal url and openweathermap API in the main script."\e[0m"
